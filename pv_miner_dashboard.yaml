# â˜€ï¸ PV Miner Dashboard
# Complete Home Assistant Dashboard for Solar Bitcoin Mining
# Replace "antminer_s21" with your actual miner entity names

title: â˜€ï¸ PV Miner Control Center
path: pv-miner
icon: mdi:bitcoin
theme: Backend-selected
panel: false
badges: []
cards:
  # Header Card with Overall Status
  - type: horizontal-stack
    cards:
      - type: entity
        entity: switch.antminer_s21_miner
        name: "ğŸ”¥ Main Miner"
        icon: mdi:pickaxe
        tap_action:
          action: toggle
      - type: entity
        entity: sensor.antminer_s21_hashrate
        name: "âš¡ Hashrate"
        icon: mdi:speedometer
      - type: entity
        entity: sensor.antminer_s21_power_consumption
        name: "ğŸ”‹ Power"
        icon: mdi:flash
      - type: entity
        entity: sensor.antminer_s21_efficiency
        name: "ğŸ“Š Efficiency"
        icon: mdi:gauge

  # Solar Power & Mining Status Section
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## ğŸŒ Solar Mining Status
      
      # Solar Power Card (you'll need to replace with your actual solar sensors)
      - type: horizontal-stack
        cards:
          - type: entity
            entity: sensor.solar_power_production  # Replace with your solar sensor
            name: "â˜€ï¸ Solar Production"
            icon: mdi:solar-power
          - type: entity
            entity: sensor.battery_soc  # Replace with your battery sensor
            name: "ğŸ”‹ Battery SOC"
            icon: mdi:battery
          - type: entity
            entity: number.antminer_s21_available_solar_power
            name: "âš¡ Available Solar"
            icon: mdi:solar-panel

  # Quick Control Buttons
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## ğŸ›ï¸ Quick Controls
      
      - type: horizontal-stack
        cards:
          - type: button
            tap_action:
              action: call-service
              service: pv_miner.wake_miner
              target:
                entity_id: switch.antminer_s21_miner
            name: "â° Wake"
            icon: mdi:power-on
            show_state: false
          
          - type: button
            tap_action:
              action: call-service
              service: pv_miner.sleep_miner
              target:
                entity_id: switch.antminer_s21_miner
            name: "ğŸ˜´ Sleep"
            icon: mdi:power-sleep
            show_state: false
          
          - type: button
            tap_action:
              action: call-service
              service: pv_miner.solar_max
              target:
                entity_id: switch.antminer_s21_miner
            name: "â˜€ï¸ Solar Max"
            icon: mdi:weather-sunny
            show_state: false
          
          - type: button
            tap_action:
              action: call-service
              service: pv_miner.eco_mode
              target:
                entity_id: switch.antminer_s21_miner
            name: "ğŸŒ± Eco Mode"
            icon: mdi:leaf
            show_state: false

  # Profile Management Section
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## âš™ï¸ Power Profile Management
      
      - type: horizontal-stack
        cards:
          - type: entity
            entity: select.antminer_s21_power_profile
            name: "ğŸšï¸ Current Profile"
            icon: mdi:tune
          
          - type: entity
            entity: select.antminer_s21_solar_mode
            name: "â˜€ï¸ Solar Mode"
            icon: mdi:solar-power-variant
      
      # Profile Quick Select Buttons
      - type: horizontal-stack
        cards:
          - type: button
            tap_action:
              action: call-service
              service: pv_miner.set_power_profile
              service_data:
                profile: "310MHz"
              target:
                entity_id: switch.antminer_s21_miner
            name: "ğŸ”‹ Eco\n310MHz"
            icon: mdi:battery-charging-low
            show_state: false
          
          - type: button
            tap_action:
              action: call-service
              service: pv_miner.set_power_profile
              service_data:
                profile: "560MHz"
              target:
                entity_id: switch.antminer_s21_miner
            name: "âš–ï¸ Balanced\n560MHz"
            icon: mdi:scale-balance
            show_state: false
          
          - type: button
            tap_action:
              action: call-service
              service: pv_miner.set_power_profile
              service_data:
                profile: "default"
              target:
                entity_id: switch.antminer_s21_miner
            name: "ğŸ”¥ Default\n710MHz"
            icon: mdi:fire
            show_state: false
          
          - type: button
            tap_action:
              action: call-service
              service: pv_miner.set_power_profile
              service_data:
                profile: "810MHz"
              target:
                entity_id: switch.antminer_s21_miner
            name: "âš¡ High\n810MHz"
            icon: mdi:lightning-bolt
            show_state: false

  # Detailed Mining Statistics
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## ğŸ“Š Mining Performance
      
      - type: horizontal-stack
        cards:
          - type: gauge
            entity: sensor.antminer_s21_hashrate
            name: "Hashrate"
            unit: "TH/s"
            min: 0
            max: 300
            severity:
              green: 200
              yellow: 100
              red: 0
          
          - type: gauge
            entity: sensor.antminer_s21_power_consumption
            name: "Power Usage"
            unit: "W"
            min: 0
            max: 8500
            severity:
              green: 0
              yellow: 5000
              red: 7000
      
      # Temperature Monitoring
      - type: horizontal-stack
        cards:
          - type: entity
            entity: sensor.antminer_s21_temperature
            name: "ğŸŒ¡ï¸ Main Temp"
            icon: mdi:thermometer
          
          - type: entity
            entity: sensor.antminer_s21_hashboard_0_temperature
            name: "ğŸ”¥ Board 0"
            icon: mdi:chip
          
          - type: entity
            entity: sensor.antminer_s21_hashboard_1_temperature
            name: "ğŸ”¥ Board 1"
            icon: mdi:chip
          
          - type: entity
            entity: sensor.antminer_s21_hashboard_2_temperature
            name: "ğŸ”¥ Board 2"
            icon: mdi:chip

  # Hashboard Individual Controls
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## ğŸ›ï¸ Individual Hashboard Control
      
      - type: horizontal-stack
        cards:
          - type: entity
            entity: switch.antminer_s21_hashboard_0
            name: "Board 0"
            icon: mdi:chip
            tap_action:
              action: toggle
          
          - type: entity
            entity: switch.antminer_s21_hashboard_1
            name: "Board 1"
            icon: mdi:chip
            tap_action:
              action: toggle
          
          - type: entity
            entity: switch.antminer_s21_hashboard_2
            name: "Board 2"
            icon: mdi:chip
            tap_action:
              action: toggle

  # Number Controls
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## ğŸ”§ Advanced Controls
      
      - type: horizontal-stack
        cards:
          - type: entity
            entity: number.antminer_s21_power_limit
            name: "âš¡ Power Limit"
            icon: mdi:flash
          
          - type: entity
            entity: number.antminer_s21_frequency_offset
            name: "ğŸšï¸ Frequency Offset"
            icon: mdi:tune

  # Additional Information
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## â„¹ï¸ System Information
      
      - type: horizontal-stack
        cards:
          - type: entity
            entity: sensor.antminer_s21_uptime
            name: "â±ï¸ Uptime"
            icon: mdi:clock
          
          - type: entity
            entity: sensor.antminer_s21_mining_pool
            name: "ğŸŠ Mining Pool"
            icon: mdi:pool
          
          - type: entity
            entity: sensor.antminer_s21_fan_speed
            name: "ğŸ’¨ Fan Speed"
            icon: mdi:fan

  # Historical Charts (requires history integration)
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## ğŸ“ˆ Performance History
      
      - type: history-graph
        entities:
          - entity: sensor.antminer_s21_hashrate
          - entity: sensor.antminer_s21_power_consumption
          - entity: sensor.antminer_s21_temperature
        hours_to_show: 24
        refresh_interval: 300
        title: "Mining Performance (24h)"

  # Solar Integration Charts
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## â˜€ï¸ Solar Integration History
      
      # You'll need to replace these with your actual solar sensors
      - type: history-graph
        entities:
          - entity: sensor.solar_power_production  # Replace with your sensor
          - entity: sensor.antminer_s21_power_consumption
          - entity: sensor.battery_soc  # Replace with your sensor
        hours_to_show: 24
        refresh_interval: 300
        title: "Solar vs Mining Power (24h)"

  # Service Call Card for Advanced Users
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## ğŸ› ï¸ Advanced Service Calls
          Use these for automation or advanced control
      
      - type: button
        tap_action:
          action: call-service
          service: pv_miner.emergency_stop
          target:
            entity_id: switch.antminer_s21_miner
        name: "ğŸš¨ Emergency Stop"
        icon: mdi:stop-circle
        show_state: false
        hold_action:
          action: more-info

  # Status Summary Card
  - type: vertical-stack
    cards:
      - type: markdown
        content: |
          ## ğŸ“‹ Quick Status Summary
          
          **ğŸ¯ Current Operation:**
          - Miner: {{ states('switch.antminer_s21_miner') | title }}
          - Profile: {{ states('select.antminer_s21_power_profile') }}
          - Hashrate: {{ states('sensor.antminer_s21_hashrate') }} TH/s
          - Power: {{ states('sensor.antminer_s21_power_consumption') }} W
          - Efficiency: {{ states('sensor.antminer_s21_efficiency') }} J/TH
          - Temperature: {{ states('sensor.antminer_s21_temperature') }}Â°C
          
          **âš¡ Power Management:**
          - Available Solar: {{ states('number.antminer_s21_available_solar_power') }} W
          - Power Limit: {{ states('number.antminer_s21_power_limit') }} W
          - Solar Mode: {{ states('select.antminer_s21_solar_mode') }}
          
          **ğŸ“Š Performance:**
          - Uptime: {{ (states('sensor.antminer_s21_uptime') | int / 3600) | round(1) }} hours
          - Pool: {{ states('sensor.antminer_s21_mining_pool') }}
          - Fan Speed: {{ states('sensor.antminer_s21_fan_speed') }} RPM